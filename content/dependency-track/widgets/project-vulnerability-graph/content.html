<div class="grid-stack-item-content-inner">
  <h1 class="title">
    {{SURI_PROJECT}} - {{SURI_PROJECT_VERSION}}
  </h1>
  <p class="title">{{SURI_TITLE}}</p>
  <div class="chart-container">
    <canvas id="chart-{{SURI_INSTANCE_ID}}"></canvas>
  </div>
  <p class="more-info">{{#fromDate}} Since {{fromDate}} {{/fromDate}}</p>

</div>
<div class="dependencytrack"></div>

<script>
      $(function(){
          $(window).on('load', loadChart{{SURI_INSTANCE_ID}});

          function loadChart{{SURI_INSTANCE_ID}}() {
              $("#chart-{{SURI_INSTANCE_ID}}").height($(".widget-{{SURI_INSTANCE_ID}}").height()-130);
              $("#chart-{{SURI_INSTANCE_ID}}").width($(".widget-{{SURI_INSTANCE_ID}}").width());
              var ctx = document.getElementById("chart-{{SURI_INSTANCE_ID}}").getContext('2d');

    	   	var labels = [];
    		var backgroundColors = [];
    		var dataCritical = [];
    		var dataHigh = [];
    		var dataMedium = [];
    		var dataLow = [];
    		var dataUnassigned = [];

    		{{#labels}}
    		labels = {{{labels}}};
    		{{/labels}}

    		{{#dataCritical}}
    		dataCritical = {{{dataCritical}}};
    		{{/dataCritical}}

    		{{#dataHigh}}
    		dataHigh = {{{dataHigh}}};
    		{{/dataHigh}}

    		{{#dataMedium}}
    		dataMedium = {{{dataMedium}}};
    		{{/dataMedium}}

    		{{#dataLow}}
    		dataLow = {{{dataLow}}};
    		{{/dataLow}}

    		{{#dataUnassigned}}
    		dataUnassigned = {{{dataUnassigned}}};
    		{{/dataUnassigned}}

    		var chart = new Chart(ctx, {
    			type: 'line',
    			data: {
    				labels: labels,
    				datasets: [
    				{
    					label: "Critical",
    					data: dataCritical,
    					borderColor: "#f86c6b",
  					    borderWidth: 3
    				},
    				{
    					label: "High",
    					data: dataHigh,
    					borderColor: "#fd8c00",
  					    borderWidth: 3
    				},
    				{
    					label: "Medium",
    					data: dataMedium,
    					borderColor: "#ffc107",
  					    borderWidth: 3
    				},
    				{
    					label: "Low",
    					data: dataLow,
    					borderColor: "#4dbd74",
  					    borderWidth: 3
    				},
    				{
    					label: "Unassigned",
    					data: dataUnassigned,
    					borderColor: "#777",
  					    borderWidth: 3
    				}


    			  ],

    			},
    		   options: {
    			   legend: {
					display: true,
    					   labels: {
    					   fontColor: "white"
    				   }
    			   },
    			   scales: {
    				   xAxes: [{
						   display: true,
    					   gridLines: {
    						   display: false
    					   },
    					   ticks: {
    						   autoSkip: true,
    						   fontColor: "#FFFFFF",
    						   maxTicksLimit: 35
    					   }
    				   }],
    					   yAxes: [{
							display: true,
    					   gridLines: {
    						   color: "rgba(255, 255, 255, 0.4)",
    						   zeroLineColor: "rgb(255, 255, 255)"
    					   },
    					   ticks: {
    						   stepSize: 5,
    						   autoSkip: true,
    						   fontColor: "#FFFFFF",
    						   maxTicksLimit: 35,
    						   beginAtZero: true
    					   }
    				   }]
    			   },
    			   pieceLabel: {
    				   render: 'value',
    					   fontSize: 18,
    					   fontStyle: 'bold',
    					   fontColor: 'white',
    					   fontFamily: '"Lucida Console", Monaco, monospace'
    			   },
    			   rotation : -0.5 * Math.PI,
    				   circumference : 2 * Math.PI
    		   },
    		   onResize: function () {
    			   $("#chart-{{SURI_INSTANCE_ID}}").height($(".widget-{{SURI_INSTANCE_ID}}").height()-130);
    			   $("#chart-{{SURI_INSTANCE_ID}}").width($(".widget-{{SURI_INSTANCE_ID}}").width());
    			   chart.update();
    		   }
    	   });
          }
          if (page_loaded) {
              loadChart{{SURI_INSTANCE_ID}}();
          }
      });
</script>
